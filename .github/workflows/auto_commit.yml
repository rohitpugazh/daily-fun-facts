name: Daily Fun Fact Auto-Update

on:
  schedule:
    - cron: '0 9 * * *'   # Every day at 9 AM UTC
  workflow_dispatch:     # Allow manual trigger too

jobs:
  update-fun-fact:
    runs-on: ubuntu-latest

    steps:
    - name: Checkout Repository
      uses: actions/checkout@v4

    - name: Fetch Fun Fact and Update Files
      run: |
        echo "Fetching a new fun fact..."
    
        RESPONSE=$(curl -s -A "Mozilla/5.0" --max-time 10 https://uselessfacts.jsph.pl/random.json?language=en)
        FACT=$(echo "$RESPONSE" | jq -r '.text')
    
        if [ -z "$FACT" ] || [ "$FACT" == "null" ]; then
          echo "API failed, using fallback fact."
          FACT="Fun Fact: Did you know that GitHub Actions can automate your life? ðŸš€"
        fi
    
        echo "Fact to use: $FACT"
    
        TODAY=$(date '+%Y-%m-%d')
    
        echo "$TODAY - $FACT" >> daily.txt
    
        echo "# ðŸŒŸ Daily Fun Fact" > README.md
        echo "" >> README.md
        echo "![Last Updated](https://img.shields.io/badge/Last_Updated-${TODAY//-/_}-blue?style=flat-square)" >> README.md
        echo "" >> README.md
        echo "**Latest Fun Fact:**" >> README.md
        echo "" >> README.md
        echo "> $FACT" >> README.md
        echo "" >> README.md
        echo "---" >> README.md
        echo "" >> README.md
        echo "Collected Fun Facts are saved in [daily.txt](daily.txt) ðŸ“š" >> README.md
    
        git config user.name "YOUR_GITHUB_USERNAME"
        git config user.email "YOUR_EMAIL@example.com"
        git add daily.txt README.md
        git commit -m "Daily Fun Fact Update: $TODAY"
        git push
  
